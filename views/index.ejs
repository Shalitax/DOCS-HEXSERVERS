<!DOCTYPE html>
<html lang="es" class="dark">
<head>
  <% if (typeof metadata !== 'undefined' && typeof baseMetadata !== 'undefined') { %>
    <%- include('partials/metadata') %>
  <% } else { %>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> | HexServers Docs</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
  <% } %>
  <link href="/css/output.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>
<body class="text-white" <% if (typeof docId !== 'undefined' && docId) { %>data-doc-id="<%= docId %>"<% } %>>
  
  <%- include('partials/header') %>

  <div class="flex pt-20">
    <%- include('partials/sidebar') %>

    <!-- Contenido principal -->
    <main class="flex-1 lg:ml-80 p-8">
      <div class="max-w-4xl mx-auto">
        <!-- Botón de edición si está logueado -->
        <% if (isAuthenticated && typeof docId !== 'undefined' && docId) { %>
          <div class="mb-6 flex justify-end">
            <button onclick="toggleEditMode()" id="editBtn" class="glass px-4 py-2 rounded-lg hover:bg-white/20 text-white transition-all font-medium shadow-lg">
              <i class="fas fa-edit mr-2"></i>Editar Documento
            </button>
          </div>
        <% } %>
        
        <article class="animate-fade-in">
          <% if (isAuthenticated && typeof docId !== 'undefined' && docId) { %>
            <div id="editContainer" class="hidden mb-6 glass rounded-xl p-6 shadow-xl">
              <textarea 
                id="contentEditor" 
                class="w-full glass px-4 py-3 rounded-lg text-white font-mono min-h-[400px] focus:outline-none focus:ring-2 focus:ring-white"
              ></textarea>
              <div class="flex space-x-3 mt-4">
                <button onclick="saveContent()" class="bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white font-semibold px-6 py-2 rounded-lg transition-all">
                  <i class="fas fa-save mr-2"></i>Guardar
                </button>
                <button onclick="cancelEdit()" class="glass px-6 py-2 rounded-lg hover:bg-white/10 transition-all text-white font-medium">
                  Cancelar
                </button>
              </div>
            </div>
          <% } %>
          
          <div class="markdown-content" id="contentDisplay">
            <%- content %>
          </div>
        </article>
        
        <!-- Footer -->
        <footer class="mt-12 text-center text-gray-500 text-sm">
          <p>© 2026 HexServers</p>
        </footer>
      </div>
    </main>
  </div>

  <!-- Overlay para mobile -->
  <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden lg:hidden z-30"></div>

  <%- include('partials/modals') %>

  <script src="/js/main.js"></script>

</body>
</html>
